<!DOCTYPE html>
<html lang="en-uk">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Playing around with nonlinear dynamics and populations in Julia.'><title>Nonlinear Dynamics — A Game of Computation (In Progress)</title>

<link rel='canonical' href='https://godot-bloggy.xyz/post/nonlinear-dynamics/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='Nonlinear Dynamics — A Game of Computation (In Progress)'>
<meta property='og:description' content='Playing around with nonlinear dynamics and populations in Julia.'>
<meta property='og:url' content='https://godot-bloggy.xyz/post/nonlinear-dynamics/'>
<meta property='og:site_name' content='｢ALL FICTION｣'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2021-04-06T21:53:06&#43;05:30'/><meta property='article:modified_time' content='2021-04-06T21:53:06&#43;05:30'/><meta property='og:image' content='https://godot-bloggy.xyz/post/nonlinear-dynamics/images/wabbitsfoxes.svg' />
<meta name="twitter:site" content="@GodotMisogi">
    <meta name="twitter:creator" content="@GodotMisogi"><meta name="twitter:title" content="Nonlinear Dynamics — A Game of Computation (In Progress)">
<meta name="twitter:description" content="Playing around with nonlinear dynamics and populations in Julia."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://godot-bloggy.xyz/post/nonlinear-dynamics/images/wabbitsfoxes.svg' />
    <link rel="shortcut icon" href="/punpun1.jpg" />

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-89998292-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    </head>
    <body class="
    article-page 
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "light");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        on-phone--column compact
    
">
    
        <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/punpun1_huab25ab071e0e366f9d0ed5a1d3b49099_44920_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">🎓</span>
                
            </figure>
            
        
        <h1 class="site-name"><a href="https://godot-bloggy.xyz/">｢ALL FICTION｣</a></h1>
        <h2 class="site-description">Arjit Seth</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about' >
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/project' >
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-files" width="44" height="44" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M15 3v4a1 1 0 0 0 1 1h4" />
  <path d="M18 17h-7a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h4l5 5v7a2 2 0 0 1 -2 2z" />
  <path d="M16 17v2a2 2 0 0 1 -2 2h-7a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h2" />
</svg>
                
                <span>Projects</span>
            </a>
        </li>
        
        

        <li >
            <a href='/music' >
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-headphones" width="44" height="44" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <rect x="4" y="13" rx="2" width="5" height="7" />
  <rect x="15" y="13" rx="2" width="5" height="7" />
  <path d="M4 15v-3a8 8 0 0 1 16 0v3" />
</svg>
                
                <span>Music</span>
            </a>
        </li>
        
        

        <li >
            <a href='/cv' >
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Curriculum Vitae</span>
            </a>
        </li>
        
        

        <li >
            <a href='https://github.com/GodotMisogi' >
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="44" height="44" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>
                
                <span>GitHub</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>Dark Mode</span>
            </li>
        
    </ol>
</aside>

    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/nonlinear-dynamics/">
                
                    <img src="/post/nonlinear-dynamics/images/wabbitsfoxes.svg" loading="lazy" alt="Featured image of post Nonlinear Dynamics — A Game of Computation (In Progress)" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/mathematics/" >
                Mathematics
            </a>
        
            <a href="/categories/programming/" >
                Programming
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/nonlinear-dynamics/">Nonlinear Dynamics — A Game of Computation (In Progress)</a>
    </h2>

    
    <h3 class="article-subtitle">
        Playing around with nonlinear dynamics and populations in Julia.
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Apr 06, 2021</time>
            </div>
        

        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <p><em>Note:</em> The code presented over here is available on my repository <a class="link" href="https://github.com/GodotMisogi/NonlinearDynamics"  target="_blank" rel="noopener"
    ><code>NonlinearDynamics</code></a>, with the additional code that was used to generate the plots shown here.</p>
<h2 id="lotka-volterra-equation">Lotka-Volterra Equation</h2>
<h3 id="introduction">Introduction</h3>
<p>The Lotka-Volterra equation governs coupled population dynamics between two species under a predator-prey relationship in a given environment. Here we will play with the populations of wabbits and foxes. Consider $x$ as the number of wabbits, and $y$ as the number of foxes. This is expressed in the form of the following autonomous system of ordinary differential equations, because populations are continuous variables.</p>
<p>$$ \begin{aligned} 
\dot x &amp; = \alpha x - \eta yx, &amp; \alpha, \eta &gt; 0 \\ 
\dot y &amp; = -\beta y + \lambda xy, &amp; \beta, \lambda &gt; 0 \\ 
\end{aligned} $$</p>
<p>Physically, these equations can be read off in the following manner: The change in the population of wabbits depends on a rate $\alpha$ proportional to the current population, and decreases at a rate $\eta$ proportional to the populations of foxes and wabbits, and similarly for the change in the population of foxes.</p>
<h3 id="critical-points">Critical Points</h3>
<p>The critical points of the system $(x_c, y_c)$ are the points at which the right-hand-sides are simultaneously zero. In this case, it&rsquo;s simple to evaluate by hand.</p>
<p>$$ \begin{aligned} 
x(\alpha - \eta y) &amp; = 0 \\ 
y(\lambda x - \beta) &amp; = 0
\end{aligned} \\ 
\implies (x_c, y_c) = \left\{ (0, 0), \left(\frac{\beta}{\lambda}, \frac{\alpha}{\eta}\right) \right\} $$</p>
<h4 id="stability">Stability</h4>
<p>At $(x_c, y_c) = (0, 0)$, any perturbation in $x$ while keeping $y$ fixed results in an increase in $\dot x$, hence it is unstable in this direction, and vice versa for $y$ and $\dot y$.</p>
<p>At $(x_c, y_c) = \left(\dfrac{\beta}{\lambda}, \dfrac{\alpha}{\eta}\right)$, we must evaluate the system by linearisation.</p>
<h3 id="computation">Computation</h3>
<p>Let&rsquo;s do it <del>to</del> in Julia. The <a class="link" href="https://diffeq.sciml.ai/stable/"  target="_blank" rel="noopener"
    ><code>DifferentialEquations.jl</code></a> package in Julia makes the setup and integration of this system very easy. The syntax of the code using the <code>@ode_def</code> macro from <a class="link" href="https://github.com/SciML/ParameterizedFunctions.jl"  target="_blank" rel="noopener"
    ><code>ParametrizedFunctions.jl</code></a> looks very similar to the mathematical presentation of the system of first-order ODEs.</p>
<div class="highlight"><pre class="chroma"><code class="language-julia" data-lang="julia"><span class="k">using</span> <span class="n">DifferentialEquations</span>

<span class="c">## ODE definition</span>
<span class="n">lotka_volterra</span> <span class="o">=</span> <span class="nd">@ode_def</span> <span class="n">LotkaVolterra</span> <span class="k">begin</span>
    <span class="n">dx</span> <span class="o">=</span>  <span class="n">α</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="n">η</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>    <span class="c"># Wabbit growth/decay</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="n">β</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">λ</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>    <span class="c"># Fox growth/decay</span>
<span class="k">end</span> <span class="n">α</span> <span class="n">β</span> <span class="n">η</span> <span class="n">λ</span>
</code></pre></div><p>As this is an initial value problem, we specify the initial conditions, parameters, and the timespan for evaluation. Let&rsquo;s start with $5$ wabbits and $1$ fox. The growth of wabbits is set to $2$ wabbits per second and the decay of foxes is set to $1$ fox per second. The decay of wabbits due to the fox population and the growth of foxes due to the rabbit population are both set to $1$ animal per second. Let&rsquo;s evaluate the evolution of this system for $1$ minute.</p>
<div class="highlight"><pre class="chroma"><code class="language-julia" data-lang="julia"><span class="c">## Inputs and parameters</span>
<span class="n">α</span><span class="p">,</span> <span class="n">β</span>  <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span>     <span class="c"># Growth/decay parameters</span>
<span class="n">η</span><span class="p">,</span> <span class="n">λ</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>     <span class="c"># Coupling parameters</span>
<span class="n">ps</span>    <span class="o">=</span> <span class="p">[</span> <span class="n">α</span> <span class="n">η</span> <span class="p">;</span>  
          <span class="n">β</span> <span class="n">λ</span> <span class="p">]</span>
<span class="n">x0</span>    <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">)</span>
</code></pre></div><p>Now we prepare an <code>ODEProblem</code> and call <code>solve</code> to begin the integration of the differential equations.</p>
<div class="highlight"><pre class="chroma"><code class="language-julia" data-lang="julia"><span class="c">## ODEProblem and solution</span>
<span class="n">run</span>   <span class="o">=</span> <span class="n">ODEFunction</span><span class="p">(</span><span class="n">lotka_volterra</span><span class="p">,</span> <span class="n">syms</span> <span class="o">=</span> <span class="p">[</span><span class="o">:</span><span class="n">Wabbits</span><span class="p">,</span> <span class="o">:</span><span class="n">Foxes</span><span class="p">])</span>
<span class="n">prob</span>  <span class="o">=</span> <span class="n">ODEProblem</span><span class="p">(</span><span class="n">run</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">ps</span><span class="p">)</span>
<span class="n">sol</span>   <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
</code></pre></div><p>This setup is sufficient to run the problem. Very short code!  (<em>My second personality</em>: But probably not shorter than the Haskell equivalent.) (<em>My third personality to the second</em>: Weird flex, but ok.) Let&rsquo;s plot the results.</p>
<center>

  
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>



<div id="/post/nonlinear-dynamics/images/wabbitsfoxes.json" class="plotly" style="width:100%"></div>
<script>
Plotly.d3.json("/post/nonlinear-dynamics/images/wabbitsfoxes.json", function(err, fig) {
    Plotly.plot('\/post\/nonlinear-dynamics\/images\/wabbitsfoxes.json', fig.data, fig.layout, {responsive: true});
});
</script>
</center>
<p>Notice how, after the maximum population of wabbits in a period, the population of foxes increases while the population of wabbits decreases to a local minimum. The foxes then quickly die off to a minimum and the population of wabbits increases, repeating the periodic cycle.</p>
<p>Now let&rsquo;s observe the behaviour near the second critical point. As this point is stable, it is expected that the population dynamics will not vary much until the numbers reach the other critical point, so let&rsquo;s run it for a longer time of about $3$ minutes.</p>
<div class="highlight"><pre class="chroma"><code class="language-julia" data-lang="julia"><span class="c">## Near stable critical point</span>
<span class="n">x0</span>    <span class="o">=</span> <span class="p">[</span><span class="n">β</span> <span class="o">/</span> <span class="n">λ</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">α</span> <span class="o">/</span> <span class="n">η</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">]</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">180.</span><span class="p">)</span>
</code></pre></div><center>



<div id="/post/nonlinear-dynamics/images/wabbitsfoxes-critical.json" class="plotly" style="width:100%"></div>
<script>
Plotly.d3.json("/post/nonlinear-dynamics/images/wabbitsfoxes-critical.json", function(err, fig) {
    Plotly.plot('\/post\/nonlinear-dynamics\/images\/wabbitsfoxes-critical.json', fig.data, fig.layout, {responsive: true});
});
</script>
</center>
<p>Here we observe a periodic solution with low amplitude which appears to be slowly diverging as expected.</p>
<h2 id="falkner-skan-boundary-layer-equations">Falkner-Skan Boundary Layer Equations</h2>
<p>The Falkner-Skan transformation of the thin shear layer equations governing boundary layers is given by the following third-order differential equation:</p>
<p>$$ F''' + \left(\frac{1 + a}{2}\right) F F'' + a\left[1 - (F')^2\right] = 0 $$</p>
<p>with boundary conditions $F(0) = F'(0) = 0, ~ F'(\eta) = 1$, where $\eta$ is some specified upper bound. This can be expressed in terms of an autonomous system of first-order differential equations: $\dot{\mathbf x} = \mathbf f(\mathbf x, \mathbf p, η)$ by setting each derivative as an independent variable.</p>
<p>$$ \frac{d}{dt} 
\begin{bmatrix} 
F \\ 
U \\ 
S 
\end{bmatrix} = 
\begin{bmatrix} 
U \\ 
S \\ 
-\left(\frac{1 + a}{2}\right) FS - a \left(1 - U^2\right)
\end{bmatrix} $$</p>
<h3 id="computation-1">Computation</h3>
<p>So we define the function for the governing ODE:</p>
<div class="highlight"><pre class="chroma"><code class="language-julia" data-lang="julia"><span class="n">falkner_skan</span> <span class="o">=</span> <span class="nd">@ode_def</span> <span class="n">FalknerSkan</span> <span class="k">begin</span>
    <span class="n">dF</span>  <span class="o">=</span> <span class="n">U</span>                                   
    <span class="n">dU</span>  <span class="o">=</span> <span class="n">S</span>                                   
    <span class="n">dS</span>  <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">S</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">U</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="k">end</span> <span class="n">a</span>
</code></pre></div><p>As this is a boundary value problem, in contrast to the previous initial value problem, another function is required to specify the boundary conditions. Note that the distinction between initial value and boundary value problems is &ldquo;superficial&rdquo;, and the mathematical treatment is generally identical as the formulation of &lsquo;space&rsquo; curves passing through specified points.</p>
<div class="highlight"><pre class="chroma"><code class="language-julia" data-lang="julia"><span class="k">function</span> <span class="n">falkner_skan_BC!</span><span class="p">(</span><span class="n">bcs</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">η</span><span class="p">)</span>
    <span class="n">bcs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>        <span class="c"># η = 0,  F  = 0</span>
    <span class="n">bcs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>        <span class="c"># η = 0,  F&#39; = 0</span>
    <span class="n">bcs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="k">end</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c"># η = ηₑ, F&#39; = 1</span>

    <span class="nb">nothing</span>
<span class="k">end</span>
</code></pre></div><p>Now we feed the functions as a <code>BVProblem</code> with the ODE and the boundary conditions, using a Mono-Implicit Runge-Kutta integration scheme to solve the discretised equations as a fully implicit system for stable integration.</p>
<div class="highlight"><pre class="chroma"><code class="language-julia" data-lang="julia"><span class="n">ηs</span>    <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">)</span>
<span class="n">x0</span>    <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> 
<span class="n">as</span>    <span class="o">=</span> <span class="n">sort</span><span class="p">([</span> <span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">10</span><span class="p">);</span> <span class="o">-</span><span class="mf">0.092</span> <span class="p">])</span>

<span class="n">prob</span>  <span class="o">=</span> <span class="n">BVProblem</span><span class="o">.</span><span class="p">(</span><span class="kt">Ref</span><span class="p">(</span><span class="n">falkner_skan_ODE!</span><span class="p">),</span> <span class="kt">Ref</span><span class="p">(</span><span class="n">falkner_skan_BC!</span><span class="p">),</span> <span class="kt">Ref</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="kt">Ref</span><span class="p">(</span><span class="n">ηs</span><span class="p">),</span> <span class="n">as</span><span class="p">,</span> <span class="n">syms</span> <span class="o">=</span> <span class="kt">Ref</span><span class="p">([</span><span class="o">:</span><span class="n">y</span><span class="p">,</span> <span class="o">:</span><span class="n">δ</span><span class="p">]))</span>
<span class="n">sol</span>   <span class="o">=</span> <span class="n">solve</span><span class="o">.</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="kt">Ref</span><span class="p">(</span><span class="n">GeneralMIRK4</span><span class="p">()),</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">2e-1</span><span class="p">)</span>
</code></pre></div><center>



<div id="/post/nonlinear-dynamics/images/falknerskan.json" class="plotly" style="width:100%"></div>
<script>
Plotly.d3.json("/post/nonlinear-dynamics/images/falknerskan.json", function(err, fig) {
    Plotly.plot('\/post\/nonlinear-dynamics\/images\/falknerskan.json', fig.data, fig.layout, {responsive: true});
});
</script>
</center>
<p>Here we can observe the incepient separation point at a specific value of $a \approx -0.0904$. Can this be figured out analytically?</p>
<h2 id="double-pendulum">Double Pendulum</h2>
<p>Refer to <a class="link" href="../../post/dubby-pendy/" >my previous post on the double pendulum</a> for a review of the theory and equations. Julia&rsquo;s various libraries and their compositions allow me to set up the differential equations, choose the integration solver, and set up plots with layouts <em>very</em> easily. This is much simpler than writing different differential equation solver algorithms and plotting tools manually for experimentation.</p>
<p>The double pendulum is a famous example of a chaotic system, and is very sensitive to time-step sizes, initial conditions, and even the solver algorithm itself due to compounding numerical noise.</p>
<h3 id="stability-and-fixed-points">Stability and Fixed Points</h3>
<p>The Lagrangian of the system is:</p>
<p>$$ \mathcal{L} = T - V  \quad \mathrm{where} \quad \begin{aligned} T &amp; = \frac{1}{2}m_1 l_1^2 \dot{\theta}_1^2 + \frac{1}{2}m_2\left[l_1^2 \dot{\theta}_1^2 + l_2^2 \dot{\theta}_2^2 + 2l_1 l_2 \dot{\theta}_1 \dot{\theta}_2 \cos(\theta_1 - \theta_2)\right] \\ V &amp; = -(m_1 + m_2)gl_1\cos \theta_1 - m_2gl_2\cos\theta_2 \end{aligned} $$</p>
<h3 id="computation-2">Computation</h3>
<p>Here the expressions are complicated and would benefit from temporary variables in the function, which are not supported in the domain-specific-language of <code>ParametrizedFunctions.jl</code>, so a regular function is prepared instead of using the <code>@ode_def</code> macro.</p>
<div class="highlight"><pre class="chroma"><code class="language-julia" data-lang="julia"><span class="c">## ODE definition</span>
<span class="k">function</span> <span class="n">dubby_pendy!</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">θ₁</span><span class="p">,</span> <span class="n">θ₂</span><span class="p">,</span> <span class="n">p₁</span><span class="p">,</span> <span class="n">p₂</span>     <span class="o">=</span> <span class="n">x</span>
    <span class="n">l₁</span><span class="p">,</span> <span class="n">l₂</span><span class="p">,</span> <span class="n">m₁</span><span class="p">,</span> <span class="n">m₂</span><span class="p">,</span> <span class="n">g</span>  <span class="o">=</span> <span class="n">ps</span>

    <span class="n">C₀</span>  <span class="o">=</span> <span class="n">l₁</span> <span class="o">*</span> <span class="n">l₂</span> <span class="o">*</span> <span class="p">(</span><span class="n">m₁</span> <span class="o">+</span> <span class="n">m₂</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">θ₁</span> <span class="o">-</span> <span class="n">θ₂</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">C₁</span>  <span class="o">=</span> <span class="p">(</span><span class="n">p₁</span> <span class="o">*</span> <span class="n">p₂</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">θ₁</span> <span class="o">-</span> <span class="n">θ₂</span><span class="p">))</span> <span class="o">/</span> <span class="n">C₀</span>
    <span class="n">C₂</span>  <span class="o">=</span> <span class="p">(</span><span class="n">m₂</span> <span class="o">*</span> <span class="p">((</span><span class="n">l₂</span> <span class="o">*</span> <span class="n">p₁</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">m₁</span> <span class="o">+</span> <span class="n">m₂</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">l₁</span> <span class="o">*</span> <span class="n">p₂</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> 
          <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">l₁</span> <span class="o">*</span> <span class="n">l₂</span> <span class="o">*</span> <span class="n">m₂</span> <span class="o">*</span> <span class="n">p₁</span> <span class="o">*</span> <span class="n">p₂</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">θ₁</span> <span class="o">-</span> <span class="n">θ₂</span><span class="p">))</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="p">(</span><span class="n">θ₁</span> <span class="o">-</span> <span class="n">θ₂</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="n">C₀</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">dx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">l₂</span> <span class="o">*</span> <span class="n">p₁</span> <span class="o">-</span> <span class="n">l₁</span> <span class="o">*</span> <span class="n">p₂</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">θ₁</span> <span class="o">-</span> <span class="n">θ₂</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">l₁</span> <span class="o">*</span> <span class="n">C₀</span><span class="p">)</span>
    <span class="n">dx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">l₁</span> <span class="o">*</span> <span class="p">(</span><span class="n">m₁</span> <span class="o">+</span> <span class="n">m₂</span><span class="p">)</span> <span class="o">*</span> <span class="n">p₂</span> <span class="o">-</span> <span class="n">l₂</span> <span class="o">*</span> <span class="n">m₂</span> <span class="o">*</span> <span class="n">p₁</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">θ₁</span> <span class="o">-</span> <span class="n">θ₂</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">l₂</span> <span class="o">*</span> <span class="n">m₂</span> <span class="o">*</span> <span class="n">C₀</span><span class="p">)</span>
    <span class="n">dx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">m₁</span> <span class="o">+</span> <span class="n">m₂</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">l₁</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">θ₁</span><span class="p">)</span> <span class="o">-</span> <span class="n">C₁</span> <span class="o">+</span> <span class="n">C₂</span>
    <span class="n">dx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">m₂</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">l₂</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">θ₂</span><span class="p">)</span> <span class="o">+</span> <span class="n">C₁</span> <span class="o">-</span> <span class="n">C₂</span>

    <span class="nb">nothing</span>
<span class="k">end</span> 
</code></pre></div><p>Let&rsquo;s set up the initial conditions and parameters and solve the problem. For the purposes of smooth plotting with a &ldquo;nice&rdquo; trajectory, I&rsquo;ve picked an adaptive Runge-Kutta method of order 4 solver with a small timestep; these choices directly influence the solutions themselves due to the chaotic nature of the system.</p>
<div class="highlight"><pre class="chroma"><code class="language-julia" data-lang="julia"><span class="c">## Inputs and parameters</span>
<span class="n">m1</span><span class="p">,</span> <span class="n">m2</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">12.0</span> <span class="c"># Masses</span>
<span class="n">l1</span><span class="p">,</span> <span class="n">l2</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">7.0</span>   <span class="c"># Lengths</span>
<span class="n">g</span>      <span class="o">=</span> <span class="mf">9.81</span>       <span class="c"># Gravitational acceleration</span>

<span class="n">ps</span>    <span class="o">=</span> <span class="p">[</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">g</span> <span class="p">]</span>
<span class="n">x0</span>    <span class="o">=</span> <span class="p">[</span> <span class="nb">π</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nb">π</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.</span> <span class="p">]</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">)</span>
<span class="n">tstep</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">dt</span>    <span class="o">=</span> <span class="n">maximum</span><span class="p">(</span><span class="n">tspan</span><span class="p">)</span> <span class="o">/</span> <span class="n">tstep</span>

<span class="c">## ODEProblem and solution</span>
<span class="n">run</span>   <span class="o">=</span> <span class="n">ODEFunction</span><span class="p">(</span><span class="n">dubby_pendy!</span><span class="p">,</span> <span class="n">syms</span> <span class="o">=</span> <span class="p">[</span><span class="o">:</span><span class="n">θ₁</span><span class="p">,</span> <span class="o">:</span><span class="n">θ₂</span><span class="p">,</span> <span class="o">:</span><span class="n">p₁</span><span class="p">,</span> <span class="o">:</span><span class="n">p₂</span><span class="p">])</span>
<span class="n">prob</span>  <span class="o">=</span> <span class="n">ODEProblem</span><span class="p">(</span><span class="n">run</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">ps</span><span class="p">)</span>
<span class="n">sol</span>   <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">RK4</span><span class="p">(),</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">df</span>    <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
</code></pre></div><center>
<video autoplay loop><source src="images/dubbypendy.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>
</center>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8"crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"integrity="sha384-vZTG03m&#43;2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl"crossorigin="anonymous"
                defer="true"
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/post/panel-methods/">
        
        
            <div class="article-image">
                <img src="/post/panel-methods/images/aeropython.ef8537f0e4805c93f164a1b955fe5faf_hu9407da34f33fa1ef28ea754b1f43ea28_133965_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="panel-methods" 
                        data-hash="md5-74U38OSAXJPxZKG5Vf5frw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Aerodynamics — Viscous-Inviscid Interacting Panel Methods (In Progress)</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/opt-problems/">
        
        
            <div class="article-image">
                
                    <img src="/post/opt-problems/XDSM.svg" loading="lazy" data-key="opt-problems" data-hash="/post/opt-problems/XDSM.svg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Gradient-Based Optimisation — Discrete Direct and Adjoint Methods (In Progress)</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/cfd-python/">
        
        
            <div class="article-image">
                
                    <img src="/post/cfd-python/images/2DPoissonSurfStud.svg" loading="lazy" data-key="cfd-python" data-hash="/post/cfd-python/images/2DPoissonSurfStud.svg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Computational Fluid Dynamics — CFDPython</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/fluid-dynamics/">
        
        

        <div class="article-details">
            <h2 class="article-title">Fluid Dynamics — A Flurry of Theory (In Progress)</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/project/academics/">
        
        
            <div class="article-image">
                
                    <img src="/project/academics/SES.svg" loading="lazy" data-key="" data-hash="/project/academics/SES.svg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Academic Notes — Physics and Mathematics</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
     
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "godotmisogi" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2016 - 
        
        2022 ｢ALL FICTION｣
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.2.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
